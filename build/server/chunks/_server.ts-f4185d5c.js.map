{"version":3,"file":"_server.ts-f4185d5c.js","sources":["../../../.svelte-kit/adapter-node/entries/endpoints/settings/_server.ts.js"],"sourcesContent":["import { c as collections } from \"../../../chunks/database.js\";\nimport { z } from \"zod\";\nimport { v as validateModel, m as models } from \"../../../chunks/models.js\";\nimport { a as authCondition } from \"../../../chunks/auth.js\";\nimport { D as DEFAULT_SETTINGS } from \"../../../chunks/Settings.js\";\nasync function POST({ request, locals }) {\n  const body = await request.json();\n  const { ethicsModalAccepted, ...settings } = z.object({\n    shareConversationsWithModelAuthors: z.boolean().default(DEFAULT_SETTINGS.shareConversationsWithModelAuthors),\n    hideEmojiOnSidebar: z.boolean().default(DEFAULT_SETTINGS.hideEmojiOnSidebar),\n    ethicsModalAccepted: z.boolean().optional(),\n    activeModel: validateModel(models).default(DEFAULT_SETTINGS.activeModel),\n    customPrompts: z.record(z.string()).default({})\n  }).parse(body);\n  await collections.settings.updateOne(\n    authCondition(locals),\n    {\n      $set: {\n        ...settings,\n        ...ethicsModalAccepted && { ethicsModalAcceptedAt: /* @__PURE__ */ new Date() },\n        updatedAt: /* @__PURE__ */ new Date()\n      },\n      $setOnInsert: {\n        createdAt: /* @__PURE__ */ new Date()\n      }\n    },\n    {\n      upsert: true\n    }\n  );\n  return new Response();\n}\nexport {\n  POST\n};\n"],"names":[],"mappings":";;;;;;;;;;;;;;;AAKA,eAAe,IAAI,CAAC,EAAE,OAAO,EAAE,MAAM,EAAE,EAAE;AACzC,EAAE,MAAM,IAAI,GAAG,MAAM,OAAO,CAAC,IAAI,EAAE,CAAC;AACpC,EAAE,MAAM,EAAE,mBAAmB,EAAE,GAAG,QAAQ,EAAE,GAAG,CAAC,CAAC,MAAM,CAAC;AACxD,IAAI,kCAAkC,EAAE,CAAC,CAAC,OAAO,EAAE,CAAC,OAAO,CAAC,gBAAgB,CAAC,kCAAkC,CAAC;AAChH,IAAI,kBAAkB,EAAE,CAAC,CAAC,OAAO,EAAE,CAAC,OAAO,CAAC,gBAAgB,CAAC,kBAAkB,CAAC;AAChF,IAAI,mBAAmB,EAAE,CAAC,CAAC,OAAO,EAAE,CAAC,QAAQ,EAAE;AAC/C,IAAI,WAAW,EAAE,aAAa,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC,gBAAgB,CAAC,WAAW,CAAC;AAC5E,IAAI,aAAa,EAAE,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,MAAM,EAAE,CAAC,CAAC,OAAO,CAAC,EAAE,CAAC;AACnD,GAAG,CAAC,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;AACjB,EAAE,MAAM,WAAW,CAAC,QAAQ,CAAC,SAAS;AACtC,IAAI,aAAa,CAAC,MAAM,CAAC;AACzB,IAAI;AACJ,MAAM,IAAI,EAAE;AACZ,QAAQ,GAAG,QAAQ;AACnB,QAAQ,GAAG,mBAAmB,IAAI,EAAE,qBAAqB,kBAAkB,IAAI,IAAI,EAAE,EAAE;AACvF,QAAQ,SAAS,kBAAkB,IAAI,IAAI,EAAE;AAC7C,OAAO;AACP,MAAM,YAAY,EAAE;AACpB,QAAQ,SAAS,kBAAkB,IAAI,IAAI,EAAE;AAC7C,OAAO;AACP,KAAK;AACL,IAAI;AACJ,MAAM,MAAM,EAAE,IAAI;AAClB,KAAK;AACL,GAAG,CAAC;AACJ,EAAE,OAAO,IAAI,QAAQ,EAAE,CAAC;AACxB;;;;"}